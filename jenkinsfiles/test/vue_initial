
pipeline {
  agent {
    kubernetes {
      yaml """
apiVersion: v1
kind: Pod
metadata:
  labels:
    some-label: jenkinsbuildnode
spec:
  containers:
  - name: jnlp
    image: 172.26.112.47/base_lib/jnlp-slave:v9
    tty: true
    volumeMounts:
    - mountPath: /var/run/docker.sock
      name: dockersock
    - mountPath: /root/.m2
      name: m2
    - mountPath: /home/jenkins/agent/workspace
      name: jenkins-workspaces
  volumes:
  - name: dockersock
    hostPath:
      path: "/var/run/docker.sock"
  - name: m2
    persistentVolumeClaim:
      claimName: m2
  - name: jenkins-workspaces
    persistentVolumeClaim:
      claimName: jenkins-workspaces
"""
    }
  }
 parameters {
  string defaultValue: 'http://47.101.131.117:3000/renlin/quanzi.git', description: '项目的git地址', name: 'project_git_url_temp', trim: false
  string defaultValue: 'dev', description: '分支名', name: 'project_branch_name_temp', trim: false
  choice choices: ['no', 'yes'], description: '是否跳过npm阶段', name: 'skip_temp'
  string defaultValue: '1', description: '要运行的副本数量', name: 'replicas_count_temp', trim: false
  string defaultValue: 'npm run build', description: '要执行的npm打包命令', name: 'build_command_temp', trim: false
 }

    options {
      buildDiscarder logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '15', numToKeepStr: '15')
    }
        stages {
      stage('success') {
        steps {
            echo "ok"
        }
      }

    }



}