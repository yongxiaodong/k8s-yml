FROM 172.26.112.47/base_lib/okvoice_base:v1
MAINTAINER  yunwei

ENV PROFILES_ACTIVE biz-test
ENV SNOW_FLAKE_WORK_ID 1
ADD target/*.jar /app.jar

VOLUME /logs
VOLUME /arthas-output
EXPOSE  9090
EXPOSE  5005

CMD touch gc.log
CMD /sbin/tini -- java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 -Xmx5440M -Xms5440M -Xmn3072M -Xss256k -XX:MaxMetaspaceSize=512M -XX:MetaspaceSize=512M -XX:+UseG1GC -XX:MaxGCPauseMillis=100 -XX:+ParallelRefProcEnabled -XX:SurvivorRatio=10 -XX:+PrintGCDetails -XX:+PrintReferenceGC -Xloggc:/gc.log -Duser.timezone=Asia/Shanghai  -jar /app.jar --spring.profiles.active=$PROFILES_ACTIVE --custom.snow-flake.worker-id=$SNOW_FLAKE_WORK_ID
